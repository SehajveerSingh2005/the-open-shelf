(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,81189,e=>{"use strict";let t=(0,e.i(62670).default)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);e.s(["ArrowRight",()=>t],81189)},34747,e=>{"use strict";e.i(52975);var t=e.i(92059),r=e.i(79307),s=e.i(32445),i=e.i(77081),a=e.i(55287),n=e.i(97365),o=e.i(33973),l=r,c=e.i(24573);function u(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}class d extends l.Component{getSnapshotBeforeUpdate(e){let t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){let e=t.offsetParent,r=(0,o.isHTMLElement)(e)&&e.offsetWidth||0,s=this.props.sizeRef.current;s.height=t.offsetHeight||0,s.width=t.offsetWidth||0,s.top=t.offsetTop,s.left=t.offsetLeft,s.right=r-s.width-s.left}return null}componentDidUpdate(){}render(){return this.props.children}}function f({children:e,isPresent:s,anchorX:i,root:a}){let n=(0,l.useId)(),o=(0,l.useRef)(null),f=(0,l.useRef)({width:0,height:0,top:0,left:0,right:0}),{nonce:p}=(0,l.useContext)(c.MotionConfigContext),h=function(...e){return r.useCallback(function(...e){return t=>{let r=!1,s=e.map(e=>{let s=u(e,t);return r||"function"!=typeof s||(r=!0),s});if(r)return()=>{for(let t=0;t<s.length;t++){let r=s[t];"function"==typeof r?r():u(e[t],null)}}}}(...e),e)}(o,e?.ref);return(0,l.useInsertionEffect)(()=>{let{width:e,height:t,top:r,left:l,right:c}=f.current;if(s||!o.current||!e||!t)return;let u="left"===i?`left: ${l}`:`right: ${c}`;o.current.dataset.motionPopId=n;let d=document.createElement("style");p&&(d.nonce=p);let h=a??document.head;return h.appendChild(d),d.sheet&&d.sheet.insertRule(`
          [data-motion-pop-id="${n}"] {
            position: absolute !important;
            width: ${e}px !important;
            height: ${t}px !important;
            ${u}px !important;
            top: ${r}px !important;
          }
        `),()=>{h.contains(d)&&h.removeChild(d)}},[s]),(0,t.jsx)(d,{isPresent:s,childRef:o,sizeRef:f,children:l.cloneElement(e,{ref:h})})}let p=({children:e,initial:s,isPresent:a,onExitComplete:o,custom:l,presenceAffectsLayout:c,mode:u,anchorX:d,root:p})=>{let m=(0,i.useConstant)(h),x=(0,r.useId)(),g=!0,y=(0,r.useMemo)(()=>(g=!1,{id:x,initial:s,isPresent:a,custom:l,onExitComplete:e=>{for(let t of(m.set(e,!0),m.values()))if(!t)return;o&&o()},register:e=>(m.set(e,!1),()=>m.delete(e))}),[a,m,o]);return c&&g&&(y={...y}),(0,r.useMemo)(()=>{m.forEach((e,t)=>m.set(t,!1))},[a]),r.useEffect(()=>{a||m.size||!o||o()},[a]),"popLayout"===u&&(e=(0,t.jsx)(f,{isPresent:a,anchorX:d,root:p,children:e})),(0,t.jsx)(n.PresenceContext.Provider,{value:y,children:e})};function h(){return new Map}var m=e.i(46313);let x=e=>e.key||"";function g(e){let t=[];return r.Children.forEach(e,e=>{(0,r.isValidElement)(e)&&t.push(e)}),t}let y=({children:e,custom:n,initial:o=!0,onExitComplete:l,presenceAffectsLayout:c=!0,mode:u="sync",propagate:d=!1,anchorX:f="left",root:h})=>{let[y,b]=(0,m.usePresence)(d),v=(0,r.useMemo)(()=>g(e),[e]),j=d&&!y?[]:v.map(x),w=(0,r.useRef)(!0),N=(0,r.useRef)(v),k=(0,i.useConstant)(()=>new Map),[C,S]=(0,r.useState)(v),[R,P]=(0,r.useState)(v);(0,a.useIsomorphicLayoutEffect)(()=>{w.current=!1,N.current=v;for(let e=0;e<R.length;e++){let t=x(R[e]);j.includes(t)?k.delete(t):!0!==k.get(t)&&k.set(t,!1)}},[R,j.length,j.join("-")]);let E=[];if(v!==C){let e=[...v];for(let t=0;t<R.length;t++){let r=R[t],s=x(r);j.includes(s)||(e.splice(t,0,r),E.push(r))}return"wait"===u&&E.length&&(e=E),P(g(e)),S(v),null}let{forceRender:z}=(0,r.useContext)(s.LayoutGroupContext);return(0,t.jsx)(t.Fragment,{children:R.map(e=>{let r=x(e),s=(!d||!!y)&&(v===R||j.includes(r));return(0,t.jsx)(p,{isPresent:s,initial:(!w.current||!!o)&&void 0,custom:n,presenceAffectsLayout:c,mode:u,root:h,onExitComplete:s?void 0:()=>{if(!k.has(r))return;k.set(r,!0);let e=!0;k.forEach(t=>{t||(e=!1)}),e&&(z?.(),P(N.current),d&&b?.(),l&&l())},anchorX:f,children:e},r)})})};e.s(["AnimatePresence",()=>y],34747)},58269,(e,t,r)=>{t.exports=e.r(12423)},65861,e=>{"use strict";var t=e.i(92059),r=e.i(79307),s=e.i(38604),i=e.i(25930),a=e.i(9854);let n=(0,i.cva)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),o=r.forwardRef(({className:e,variant:r,size:i,asChild:o=!1,...l},c)=>{let u=o?s.Slot:"button";return(0,t.jsx)(u,{className:(0,a.cn)(n({variant:r,size:i,className:e})),ref:c,...l})});o.displayName="Button",e.s(["Button",()=>o])},46416,24457,62125,e=>{"use strict";var t=e.i(92059),r=e.i(79307),s=e.i(9854);let i=r.forwardRef(({className:e,type:r,...i},a)=>(0,t.jsx)("input",{type:r,className:(0,s.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:a,...i}));i.displayName="Input",e.s(["Input",()=>i],46416);let a=(0,e.i(62670).default)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>a],24457);var n=e.i(75680);e.s(["showError",0,e=>{n.toast.error(e)},"showSuccess",0,e=>{n.toast.success(e)}],62125)},27715,e=>{"use strict";let t=(0,e.i(62670).default)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>t],27715)},21127,e=>{"use strict";var t=e.i(92059),r=e.i(79307),s=e.i(58269),i=e.i(32791),a=e.i(34747),n=e.i(53379),o=e.i(11872),l=e.i(65861),c=e.i(46416),u=e.i(62670);let d=(0,u.default)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);var f=e.i(81189),p=e.i(27715),h=e.i(24457);let m=(0,u.default)("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);var x=e.i(62125);e.s(["default",0,()=>{let{user:e}=(0,o.useAuth)(),u=(0,s.useRouter)(),[g,y]=(0,r.useState)(1),[b,v]=(0,r.useState)(!1),[j,w]=(0,r.useState)([]),[N,k]=(0,r.useState)([]),[C,S]=(0,r.useState)([]),[R,P]=(0,r.useState)([]),[E,z]=(0,r.useState)("");(0,r.useEffect)(()=>{M()},[]);let M=async()=>{let{data:e}=await n.supabase.from("topics").select("*");e&&w(e)},L=async()=>{v(!0);let{data:e}=await n.supabase.from("suggested_feeds").select("*").in("topic_id",j.filter(e=>N.includes(e.slug)).map(e=>e.id));e&&(S(e),P(e.map(e=>e.url))),v(!1),y(2)},A=async()=>{v(!0);try{let t=C.filter(e=>R.includes(e.url)).map(t=>({url:t.url,title:t.title,user_id:e?.id}));if(t.length>0){let{error:e}=await n.supabase.from("feeds").upsert(t,{onConflict:"url,user_id"});if(e)throw e;for(let e of t)await n.supabase.functions.invoke("fetch-rss",{body:{feedUrl:e.url}})}let{error:r}=await n.supabase.from("profiles").update({onboarding_completed:!0,interests:N}).eq("id",e?.id);if(r)throw r;(0,x.showSuccess)("Welcome to your shelf."),u.push("/shelf")}catch(e){console.error("Onboarding error:",e),(0,x.showError)("Something went wrong finalizing your shelf.")}finally{v(!1)}},B=async e=>{if(e.preventDefault(),E){v(!0);try{let{error:e}=await n.supabase.functions.invoke("fetch-rss",{body:{feedUrl:E}});if(e)throw e;let{data:t}=await n.supabase.from("feeds").select("title").eq("url",E).single();P(e=>[...e,E]),S(e=>[...e,{title:t?.title||"Custom Source",url:E}]),z(""),(0,x.showSuccess)("Custom source added")}catch(e){(0,x.showError)("Invalid RSS feed.")}finally{v(!1)}}};return(0,t.jsx)("div",{className:"min-h-screen w-full bg-white flex flex-col items-center justify-center px-6 py-12",children:(0,t.jsx)("div",{className:"w-full max-w-2xl",children:(0,t.jsxs)(a.AnimatePresence,{mode:"wait",children:[1===g&&(0,t.jsxs)(i.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-8",children:[(0,t.jsxs)("div",{className:"space-y-4 text-center",children:[(0,t.jsx)("span",{className:"text-[10px] uppercase tracking-[0.5em] font-sans font-bold text-gray-400",children:"Step 01 / 02"}),(0,t.jsxs)("h2",{className:"text-4xl font-serif font-medium text-gray-900 leading-tight",children:["What defines your ",(0,t.jsx)("br",{}),(0,t.jsx)("span",{className:"italic",children:"curiosity?"})]}),(0,t.jsx)("p",{className:"text-gray-400 font-serif italic text-base",children:"Select the themes you wish to cultivate."})]}),(0,t.jsx)("div",{className:"flex flex-wrap justify-center gap-2",children:j.map(e=>(0,t.jsx)("button",{onClick:()=>{var t;return t=e.slug,void k(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t])},className:`px-6 py-3 border transition-all duration-500 text-[10px] uppercase tracking-[0.3em] font-bold ${N.includes(e.slug)?"bg-gray-900 border-gray-900 text-white":"bg-white border-gray-100 text-gray-400 hover:border-gray-900 hover:text-gray-900"}`,children:e.name},e.id))}),(0,t.jsx)("div",{className:"flex justify-center pt-4",children:(0,t.jsx)(l.Button,{onClick:L,disabled:0===N.length||b,className:"rounded-none bg-white text-gray-900 border border-gray-100 hover:border-gray-900 hover:bg-white h-14 px-10 text-[10px] uppercase tracking-[0.4em] font-bold",children:b?(0,t.jsx)(p.Loader2,{className:"animate-spin"}):(0,t.jsxs)(t.Fragment,{children:["Next Step ",(0,t.jsx)(f.ArrowRight,{size:14,className:"ml-4"})]})})})]},"step1"),2===g&&(0,t.jsxs)(i.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-8",children:[(0,t.jsxs)("div",{className:"space-y-4 text-center",children:[(0,t.jsx)("span",{className:"text-[10px] uppercase tracking-[0.5em] font-sans font-bold text-gray-400",children:"Step 02 / 02"}),(0,t.jsxs)("h2",{className:"text-4xl font-serif font-medium text-gray-900 leading-tight",children:["Seeding your ",(0,t.jsx)("br",{}),(0,t.jsx)("span",{className:"italic",children:"collection."})]}),(0,t.jsx)("p",{className:"text-gray-400 font-serif italic text-base",children:"Sources gathered based on your interests."})]}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 max-h-[300px] overflow-y-auto pr-2 scrollbar-thin",children:C.map(e=>(0,t.jsxs)("button",{onClick:()=>{var t;return t=e.url,void P(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t])},className:`flex items-center justify-between p-4 border transition-all duration-300 ${R.includes(e.url)?"border-gray-900 bg-gray-50/50":"border-gray-100 bg-white hover:border-gray-300"}`,children:[(0,t.jsxs)("div",{className:"text-left overflow-hidden",children:[(0,t.jsx)("p",{className:"font-serif font-medium text-base text-gray-900 truncate",children:e.title}),(0,t.jsx)("p",{className:"text-[8px] uppercase tracking-widest text-gray-400 truncate w-full",children:e.url})]}),R.includes(e.url)&&(0,t.jsx)(d,{size:14,className:"text-gray-900 shrink-0 ml-2"})]},e.url))}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("p",{className:"text-[9px] uppercase tracking-[0.2em] font-bold text-gray-400 text-center",children:"Or add a custom source"}),(0,t.jsxs)("form",{onSubmit:B,className:"flex gap-2",children:[(0,t.jsxs)("div",{className:"relative flex-1",children:[(0,t.jsx)(m,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-300",size:14}),(0,t.jsx)(c.Input,{placeholder:"https://substack.com/feed",value:E,onChange:e=>z(e.target.value),className:"h-12 pl-12 rounded-none border-gray-100 focus:border-gray-900"})]}),(0,t.jsx)(l.Button,{type:"submit",disabled:b,variant:"outline",className:"h-12 rounded-none px-6 border-gray-100 hover:border-gray-900",children:(0,t.jsx)(h.Plus,{size:16})})]})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center pt-4",children:[(0,t.jsx)("button",{onClick:()=>y(1),className:"text-[10px] uppercase tracking-[0.4em] font-bold text-gray-400 hover:text-gray-900",children:"Back"}),(0,t.jsx)(l.Button,{onClick:A,disabled:b,className:"rounded-none bg-gray-900 text-white h-14 px-10 text-[10px] uppercase tracking-[0.4em] font-bold",children:b?(0,t.jsx)(p.Loader2,{className:"animate-spin"}):"Complete Shelf"})]})]},"step2")]})})})}],21127)}]);