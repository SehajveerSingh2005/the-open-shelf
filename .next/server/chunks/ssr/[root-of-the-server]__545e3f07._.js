module.exports=[14249,(a,b,c)=>{"use strict";b.exports=a.r(63028).vendored.contexts.HooksClientContext},82024,(a,b,c)=>{"use strict";b.exports=a.r(63028).vendored.contexts.ServerInsertedHtml},56704,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},20635,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},80355,(a,b,c)=>{"use strict";b.exports=a.r(63028).vendored.contexts.AppRouterContext},89597,a=>{"use strict";let b=(0,a.i(93594).default)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);a.s(["ArrowRight",()=>b],89597)},29541,a=>{"use strict";var b=a.i(61485),c=a.i(96894),d=a.i(27230),e=a.i(40385),f=a.i(90936),g=a.i(43383),h=a.i(23211),i=a.i(93074),j=a.i(47374),k=a.i(93594);let l=(0,k.default)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);var m=a.i(89597),n=a.i(93249),o=a.i(30513);let p=(0,k.default)("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);var q=a.i(61458);a.s(["default",0,()=>{let{user:a}=(0,h.useAuth)(),k=(0,d.useRouter)(),[r,s]=(0,c.useState)(1),[t,u]=(0,c.useState)(!1),[v,w]=(0,c.useState)([]),[x,y]=(0,c.useState)([]),[z,A]=(0,c.useState)([]),[B,C]=(0,c.useState)([]),[D,E]=(0,c.useState)("");(0,c.useEffect)(()=>{F()},[]);let F=async()=>{let{data:a}=await g.supabase.from("topics").select("*");a&&w(a)},G=async()=>{u(!0);let{data:a}=await g.supabase.from("suggested_feeds").select("*").in("topic_id",v.filter(a=>x.includes(a.slug)).map(a=>a.id));a&&(A(a),C(a.map(a=>a.url))),u(!1),s(2)},H=async()=>{u(!0);try{let b=z.filter(a=>B.includes(a.url)).map(b=>({url:b.url,title:b.title,user_id:a?.id}));if(b.length>0){let{error:a}=await g.supabase.from("feeds").upsert(b,{onConflict:"url,user_id"});if(a)throw a;for(let a of b)await g.supabase.functions.invoke("fetch-rss",{body:{feedUrl:a.url}})}let{error:c}=await g.supabase.from("profiles").update({onboarding_completed:!0,interests:x}).eq("id",a?.id);if(c)throw c;(0,q.showSuccess)("Welcome to your shelf."),k.push("/shelf")}catch(a){console.error("Onboarding error:",a),(0,q.showError)("Something went wrong finalizing your shelf.")}finally{u(!1)}},I=async a=>{if(a.preventDefault(),D){u(!0);try{let{error:a}=await g.supabase.functions.invoke("fetch-rss",{body:{feedUrl:D}});if(a)throw a;let{data:b}=await g.supabase.from("feeds").select("title").eq("url",D).single();C(a=>[...a,D]),A(a=>[...a,{title:b?.title||"Custom Source",url:D}]),E(""),(0,q.showSuccess)("Custom source added")}catch(a){(0,q.showError)("Invalid RSS feed.")}finally{u(!1)}}};return(0,b.jsx)("div",{className:"min-h-screen w-full bg-white flex flex-col items-center justify-center px-6 py-12",children:(0,b.jsx)("div",{className:"w-full max-w-2xl",children:(0,b.jsxs)(f.AnimatePresence,{mode:"wait",children:[1===r&&(0,b.jsxs)(e.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-8",children:[(0,b.jsxs)("div",{className:"space-y-4 text-center",children:[(0,b.jsx)("span",{className:"text-[10px] uppercase tracking-[0.5em] font-sans font-bold text-gray-400",children:"Step 01 / 02"}),(0,b.jsxs)("h2",{className:"text-4xl font-serif font-medium text-gray-900 leading-tight",children:["What defines your ",(0,b.jsx)("br",{}),(0,b.jsx)("span",{className:"italic",children:"curiosity?"})]}),(0,b.jsx)("p",{className:"text-gray-400 font-serif italic text-base",children:"Select the themes you wish to cultivate."})]}),(0,b.jsx)("div",{className:"flex flex-wrap justify-center gap-2",children:v.map(a=>(0,b.jsx)("button",{onClick:()=>{var b;return b=a.slug,void y(a=>a.includes(b)?a.filter(a=>a!==b):[...a,b])},className:`px-6 py-3 border transition-all duration-500 text-[10px] uppercase tracking-[0.3em] font-bold ${x.includes(a.slug)?"bg-gray-900 border-gray-900 text-white":"bg-white border-gray-100 text-gray-400 hover:border-gray-900 hover:text-gray-900"}`,children:a.name},a.id))}),(0,b.jsx)("div",{className:"flex justify-center pt-4",children:(0,b.jsx)(i.Button,{onClick:G,disabled:0===x.length||t,className:"rounded-none bg-white text-gray-900 border border-gray-100 hover:border-gray-900 hover:bg-white h-14 px-10 text-[10px] uppercase tracking-[0.4em] font-bold",children:t?(0,b.jsx)(n.Loader2,{className:"animate-spin"}):(0,b.jsxs)(b.Fragment,{children:["Next Step ",(0,b.jsx)(m.ArrowRight,{size:14,className:"ml-4"})]})})})]},"step1"),2===r&&(0,b.jsxs)(e.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-8",children:[(0,b.jsxs)("div",{className:"space-y-4 text-center",children:[(0,b.jsx)("span",{className:"text-[10px] uppercase tracking-[0.5em] font-sans font-bold text-gray-400",children:"Step 02 / 02"}),(0,b.jsxs)("h2",{className:"text-4xl font-serif font-medium text-gray-900 leading-tight",children:["Seeding your ",(0,b.jsx)("br",{}),(0,b.jsx)("span",{className:"italic",children:"collection."})]}),(0,b.jsx)("p",{className:"text-gray-400 font-serif italic text-base",children:"Sources gathered based on your interests."})]}),(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 max-h-[300px] overflow-y-auto pr-2 scrollbar-thin",children:z.map(a=>(0,b.jsxs)("button",{onClick:()=>{var b;return b=a.url,void C(a=>a.includes(b)?a.filter(a=>a!==b):[...a,b])},className:`flex items-center justify-between p-4 border transition-all duration-300 ${B.includes(a.url)?"border-gray-900 bg-gray-50/50":"border-gray-100 bg-white hover:border-gray-300"}`,children:[(0,b.jsxs)("div",{className:"text-left overflow-hidden",children:[(0,b.jsx)("p",{className:"font-serif font-medium text-base text-gray-900 truncate",children:a.title}),(0,b.jsx)("p",{className:"text-[8px] uppercase tracking-widest text-gray-400 truncate w-full",children:a.url})]}),B.includes(a.url)&&(0,b.jsx)(l,{size:14,className:"text-gray-900 shrink-0 ml-2"})]},a.url))}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)("p",{className:"text-[9px] uppercase tracking-[0.2em] font-bold text-gray-400 text-center",children:"Or add a custom source"}),(0,b.jsxs)("form",{onSubmit:I,className:"flex gap-2",children:[(0,b.jsxs)("div",{className:"relative flex-1",children:[(0,b.jsx)(p,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-300",size:14}),(0,b.jsx)(j.Input,{placeholder:"https://substack.com/feed",value:D,onChange:a=>E(a.target.value),className:"h-12 pl-12 rounded-none border-gray-100 focus:border-gray-900"})]}),(0,b.jsx)(i.Button,{type:"submit",disabled:t,variant:"outline",className:"h-12 rounded-none px-6 border-gray-100 hover:border-gray-900",children:(0,b.jsx)(o.Plus,{size:16})})]})]}),(0,b.jsxs)("div",{className:"flex justify-between items-center pt-4",children:[(0,b.jsx)("button",{onClick:()=>s(1),className:"text-[10px] uppercase tracking-[0.4em] font-bold text-gray-400 hover:text-gray-900",children:"Back"}),(0,b.jsx)(i.Button,{onClick:H,disabled:t,className:"rounded-none bg-gray-900 text-white h-14 px-10 text-[10px] uppercase tracking-[0.4em] font-bold",children:t?(0,b.jsx)(n.Loader2,{className:"animate-spin"}):"Complete Shelf"})]})]},"step2")]})})})}],29541)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__545e3f07._.js.map